% #RSS vs #spike

clear all
close all
fclose('all');

% *********************************
% *** Parameters for simulation ***
% *********************************
strEnv = {'stim100' 'addstdp' 'mltstdp' 'stim050' 'stim060' 'stim070' 'stim080' 'stim090'};
strData =  {'50[Hz]' '100[Hz]' '200[Hz]' '0.3[-]' '0.5[-]' '0.7[-]'};
strTest =  {'1,000[msec](same)' '2,000[msec](same)' '4,000[msec](same)'...
			'1,000[msec](diff)' '2,000[msec](diff)' '4,000[msec](diff)'...
			'wo-learning' 'wo-input mod' ' wo-learning & input mod'};
strCmp = {'02' '04' '06' '08' '10' '12' '14' '16' '18' '20'};
strTrl = {'01' '02' '03' '04' '05' '06' '07' '08' '09' '10'};

pltEnv  = 1:3;	%Simulation environment
pltData = 1:6;	%Data number
pltTest = 1:7;  %Data-test number
pltCmp  = 5:5;  %Sequence compression ratio
pltTrl  = 1:10; %After learning trial number

STIM_TIME = 500;
ID_G1 = 1:100;
ID_G2 = 101:200;
ID_OTHER = 201:400;
NUM_EXC = 400;

tbin = 25; % [ms]: default=25ms corresponds 40Hz(Gamma range)
trange = [0 110000]; % range for total PCA
tstarts = [0 100000 105000]; % range for specific period
tdurs = [100000 5000 500];
tends = tstarts + tdurs;

data_dir = '/Users/matsu/Research/LogSTDP';
working_dir = '/Users/matsu/Documents/MATLAB/LogSTDP';
% ********************
% *** Main routine ***
% ********************
for i = pltEnv
	for j = pltData
		for k = pltTest
			for l = pltCmp
				for m = pltTrl
                    load_dir = sprintf('%s/mod-code-longstim02-%s/data%d/data-test0%d',data_dir,strEnv{i},j,k);
                    seqdata_length = load(sprintf('%s/sequences%s-c%s.length',load_dir,strTrl{m},strCmp{l}));
					nSeq(1,m) = size(seqdata_length,1);

					spike = load(sprintf('%s/espk.%s',load_dir,strTrl{m}));
					spikeSA(1,m) = length(find(500<=spike(:,1)&spike(:,1)<1000));
					spikeEA(1,m) = length(find(1000<=spike(:,1)&spike(:,1)<1500));
				end
				seq_mean(i,j,k) = mean(nSeq);
				seq_std(i,j,k) = std(nSeq);
				SA_mean(i,j,k) = mean(spikeSA);
				SA_std(i,j,k) = std(spikeSA);
				EA_mean(i,j,k) = mean(spikeEA);
				EA_std(i,j,k) = std(spikeEA);
%				nSeqMean(j,k) = mean(nSeq);
%				nSeqStd(j,k) = std(nSeq);
%				spikeSAMean(j,k) = mean(spikeSA);
%				spikeEAMean(j,k) = mean(spikeEA);
%				spikeSAStd(j,k) = std(spikeSA);
%				spikeEAStd(j,k) = std(spikeEA);
			end
			fprintf('For loop have finished until test0%d\n',k);
		end %for k : data-test
		figure
		set(gcf,'Name',sprintf('%s-%s',strEnv{i},strData{j}))
		title(sprintf('%s-%s',strEnv{i},strData{j}))
		errorbar(seq_mean(i,j,:),seq_std(i,j,:),'r');hold on
		errorbar(SA_mean(i,j,:),SA_std(i,j,:),'g');hold on
		errorbar(EA_mean(i,j,:),EA_std(i,j,:),'b')
		legend('#RSS','#spike of SA','#spike of EA')
		fprintf('For loop have finished until data%d\n',j);
	end %for j : data
	fprintf('For loop have finished until simu env%d\n',i);
end	%for i : simulation environment

%for j = pltData
%	figure
%	set(gcf,'Name',sprintf('stim100-%s',strData{j}))
%	title(sprintf('stim100-%s',strData{j}))
%	errorbar(nSeqMean(j,:),nSeqStd(j,:),'g');hold on
%	errorbar(spikeSAMean(j,:),spikeSAStd(j,:),'b');hold on
%	errorbar(spikeEAMean(j,:),spikeEAStd(j,:),'r')
%	legend('#RSS','#spike of SA','#spike of EA')
%end
%for k = pltTest
%	figure
%	set(gcf,'Name',sprintf('stim100-%s',strTest{k}))
%	title(sprintf('stim100-%s',strData{j}))
%	errorbar(nSeqMean(:,k),nSeqStd(:,k),'g');hold on
%	errorbar(spikeSAMean(:,k),spikeSAStd(:,k),'b');hold on
%	errorbar(spikeEAMean(:,k),spikeEAStd(:,k),'r')
%	legend('#RSS','#spike of SA','#spike of EA')
%end
