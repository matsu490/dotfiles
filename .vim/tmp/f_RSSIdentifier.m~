function [ seqdata_id ] = f_RSSIdentifier( seqdata, seqdata_length )

% Identifing RSS
idHead = find(seqdata(:,3)==1);
idSA = idHead(find(seqdata(idHead,1)<=1000));
idEA = idHead(find(seqdata(idHead,1)>=1000));
idSA2 = find(seqdata(idHead,1)<=1000);
idEA2 = find(seqdata(idHead,1)>=1000);
SeqLenSA = seqdata_length(idSA2,:);
SeqLenEA = seqdata_length(idEA2,:);
seqdata(:,5) = 0;
seqdata_length(:,3) = 0;
%IsiHtoH = 0;
for n = 1:size(SeqLenSA,1)
	Combo = SeqLenSA(n,2);
	idSeqH_SA = idSA(n,1);
	idSeqT_SA = idSA(n,1)+Combo-1;
	NeuIdSA = seqdata(idSeqH_SA:idSeqT_SA,2);
	IsiSA = diff(seqdata(idSeqH_SA:idSeqT_SA,1));
	vecSA = [NeuIdSA; IsiSA];

	idCand = find(SeqLenEA(:,1)==SeqLenSA(n,1) & SeqLenEA(:,2)==SeqLenSA(n,2));
	cent = 0;
	for o = 1:size(idCand,1)
		idCandTmp = idCand(o,1);

		idSeqH_EA = idEA(idCandTmp,1);
		idSeqT_EA = idEA(idCandTmp,1)+Combo-1;
		NeuIdEA = seqdata(idSeqH_EA:idSeqT_EA,2);
		IsiEA = diff(seqdata(idSeqH_EA:idSeqT_EA,1));
		vecEA = [NeuIdEA; IsiEA];

		if sum(vecSA==vecEA)==size(vecSA,1)
			idPareSA = idSA2(n,1);
			idPareEA = idEA2(idCandTmp,1);
			cent = cent + 1;
			if cent~=1
				%[vecSA vecEA]
				disp('Conflict!')
			end
			seqdata(idSeqH_SA:idSeqT_SA,5) = n;
			seqdata(idSeqH_EA:idSeqT_EA,5) = n;
			seqdata_length(idPareSA,3) = n;
			seqdata_length(idPareEA,3) = n;

			%IsiHtoH = [IsiHtoH;seqdata(idSeqH_EA,1)-seqdata(idSeqH_SA,1)];
		end
	end
end
seqdata_id = seqdata;
